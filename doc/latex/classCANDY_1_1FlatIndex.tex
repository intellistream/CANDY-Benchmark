\hypertarget{classCANDY_1_1FlatIndex}{}\doxysection{CANDY\+::Flat\+Index Class Reference}
\label{classCANDY_1_1FlatIndex}\index{CANDY::KNNSearch@{CANDY::KNNSearch}}


The class of a flat index approach, using brutal force management.  




{\ttfamily \#include $<$CANDY/\+Flat\+Index.\+h$>$}



Inheritance diagram for CANDY\+::Flat\+Index\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=203pt]{classCANDY_1_1FlatIndex__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for CANDY\+::Flat\+Index\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classCANDY_1_1FlatIndex__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classCANDY_1_1FlatIndex_a9d1eb0731ce4904512d52814386a3c55}\label{classCANDY_1_1FlatIndex_a9d1eb0731ce4904512d52814386a3c55}} 
virtual void \mbox{\hyperlink{classCANDY_1_1FlatIndex_a9d1eb0731ce4904512d52814386a3c55}{reset}} ()
\begin{DoxyCompactList}\small\item\em reset this index to inited status \end{DoxyCompactList}\item 
virtual bool \mbox{\hyperlink{classCANDY_1_1FlatIndex_a67e201cac16e382a9735fc671a04ff26}{set\+Config}} (\mbox{\hyperlink{group__INTELLI__UTIL__CONFIGS_gaeb9674f6f5860b687d73f618962dfcea}{INTELLI\+::\+Config\+Map\+Ptr}} cfg)
\begin{DoxyCompactList}\small\item\em set the index-\/specific config related to one index \end{DoxyCompactList}\item 
virtual bool \mbox{\hyperlink{classCANDY_1_1FlatIndex_a80608780f9aac45e9298a90731056fcf}{insert\+Tensor}} (torch\+::\+Tensor \&t)
\begin{DoxyCompactList}\small\item\em insert a tensor \end{DoxyCompactList}\item 
virtual bool \mbox{\hyperlink{classCANDY_1_1FlatIndex_a5302cde90e75103b7402033596fabe08}{delete\+Tensor}} (torch\+::\+Tensor \&t, int64\+\_\+t k=1)
\begin{DoxyCompactList}\small\item\em delete a tensor \end{DoxyCompactList}\item 
virtual bool \mbox{\hyperlink{classCANDY_1_1FlatIndex_a503565d2118cc8e5c70bb9356a9ffcb7}{revise\+Tensor}} (torch\+::\+Tensor \&t, torch\+::\+Tensor \&w)
\begin{DoxyCompactList}\small\item\em revise a tensor \end{DoxyCompactList}\item 
virtual std\+::vector$<$ faiss\+::idx\+\_\+t $>$ \mbox{\hyperlink{classCANDY_1_1FlatIndex_a1b1113af83b973be31c34994a5e87f11}{search\+Index}} (torch\+::\+Tensor q, int64\+\_\+t k)
\begin{DoxyCompactList}\small\item\em search the k-\/\+NN of a query tensor, return their index \end{DoxyCompactList}\item 
virtual std\+::vector$<$ torch\+::\+Tensor $>$ \mbox{\hyperlink{classCANDY_1_1FlatIndex_ac9ab4989ff2215d81fb1dc7c7d22ed6c}{search\+Tensor}} (torch\+::\+Tensor \&q, int64\+\_\+t k)
\begin{DoxyCompactList}\small\item\em search the k-\/\+NN of a query tensor, return the result tensors \end{DoxyCompactList}\item 
virtual std\+::vector$<$ torch\+::\+Tensor $>$ \mbox{\hyperlink{classCANDY_1_1FlatIndex_ac43417e20eb7653d7f74c91295274e36}{get\+Tensor\+By\+Index}} (std\+::vector$<$ faiss\+::idx\+\_\+t $>$ \&idx, int64\+\_\+t k)
\begin{DoxyCompactList}\small\item\em return a vector of tensors according to some index \end{DoxyCompactList}\item 
virtual torch\+::\+Tensor \mbox{\hyperlink{classCANDY_1_1FlatIndex_a44c1a243c76f7a54b5c01c57aba83ff2}{raw\+Data}} ()
\begin{DoxyCompactList}\small\item\em return the raw\+Data of tensor \end{DoxyCompactList}\item 
virtual int64\+\_\+t \mbox{\hyperlink{classCANDY_1_1FlatIndex_ae598008bed9612befba457d842bb098b}{size}} ()
\begin{DoxyCompactList}\small\item\em return the size of ingested tensors \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classCANDY_1_1FlatIndex_a5417dc89caba75d330980bddcc6e26ca}\label{classCANDY_1_1FlatIndex_a5417dc89caba75d330980bddcc6e26ca}} 
\mbox{\hyperlink{group__INTELLI__UTIL__CONFIGS_gaeb9674f6f5860b687d73f618962dfcea}{INTELLI\+::\+Config\+Map\+Ptr}} {\bfseries my\+Cfg} = nullptr
\item 
\mbox{\Hypertarget{classCANDY_1_1FlatIndex_aa0cf79d09cc8aa7012a0aa43f728ccf3}\label{classCANDY_1_1FlatIndex_aa0cf79d09cc8aa7012a0aa43f728ccf3}} 
torch\+::\+Tensor {\bfseries db\+Tensor}
\item 
\mbox{\Hypertarget{classCANDY_1_1FlatIndex_a3fdb3f4665a217f2f2d281e546473896}\label{classCANDY_1_1FlatIndex_a3fdb3f4665a217f2f2d281e546473896}} 
int64\+\_\+t {\bfseries last\+NNZ} = 0
\item 
\mbox{\Hypertarget{classCANDY_1_1FlatIndex_a6d5e9393fed79a90233f9a8f5cc79061}\label{classCANDY_1_1FlatIndex_a6d5e9393fed79a90233f9a8f5cc79061}} 
int64\+\_\+t {\bfseries vec\+Dim} = 0
\item 
\mbox{\Hypertarget{classCANDY_1_1FlatIndex_ab541f6a9b3139c13c28c4311c16fdb8e}\label{classCANDY_1_1FlatIndex_ab541f6a9b3139c13c28c4311c16fdb8e}} 
int64\+\_\+t {\bfseries initial\+Volume} = 1000
\item 
\mbox{\Hypertarget{classCANDY_1_1FlatIndex_ace1f6473c6eac5aae04786fcfb90226a}\label{classCANDY_1_1FlatIndex_ace1f6473c6eac5aae04786fcfb90226a}} 
int64\+\_\+t {\bfseries expand\+Step} = 100
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}
The class of a flat index approach, using brutal force management. 

\begin{DoxyNote}{Note}
currently single thread 

config parameters
\begin{DoxyItemize}
\item vec\+Dim, the dimension of vectors, default 768, I64
\item initial\+Volume, the initial volume of inline database tensor, default 1000, I64
\item expand\+Step, the step of expanding inline database, default 100, I64 
\end{DoxyItemize}
\end{DoxyNote}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classCANDY_1_1FlatIndex_a5302cde90e75103b7402033596fabe08}\label{classCANDY_1_1FlatIndex_a5302cde90e75103b7402033596fabe08}} 
\index{CANDY::KNNSearch@{CANDY::KNNSearch}!deleteTensor@{deleteTensor}}
\index{deleteTensor@{deleteTensor}!CANDY::KNNSearch@{CANDY::KNNSearch}}
\doxysubsubsection{\texorpdfstring{deleteTensor()}{deleteTensor()}}
{\footnotesize\ttfamily bool CANDY\+::\+Flat\+Index\+::delete\+Tensor (\begin{DoxyParamCaption}\item[{torch\+::\+Tensor \&}]{t,  }\item[{int64\+\_\+t}]{k = {\ttfamily 1} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



delete a tensor 


\begin{DoxyParams}{Parameters}
{\em t} & the tensor, recommend single row \\
\hline
{\em k} & the number of nearest neighbors \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
bool whether the deleting is successful 
\end{DoxyReturn}


Reimplemented from \mbox{\hyperlink{classCANDY_1_1AbstractIndex_a56adc37171b02a9e667f10e35c0682d8}{CANDY\+::\+Abstract\+Index}}.

\mbox{\Hypertarget{classCANDY_1_1FlatIndex_ac43417e20eb7653d7f74c91295274e36}\label{classCANDY_1_1FlatIndex_ac43417e20eb7653d7f74c91295274e36}} 
\index{CANDY::KNNSearch@{CANDY::KNNSearch}!getTensorByIndex@{getTensorByIndex}}
\index{getTensorByIndex@{getTensorByIndex}!CANDY::KNNSearch@{CANDY::KNNSearch}}
\doxysubsubsection{\texorpdfstring{getTensorByIndex()}{getTensorByIndex()}}
{\footnotesize\ttfamily std\+::vector$<$ torch\+::\+Tensor $>$ CANDY\+::\+Flat\+Index\+::get\+Tensor\+By\+Index (\begin{DoxyParamCaption}\item[{std\+::vector$<$ faiss\+::idx\+\_\+t $>$ \&}]{idx,  }\item[{int64\+\_\+t}]{k }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



return a vector of tensors according to some index 


\begin{DoxyParams}{Parameters}
{\em idx} & the index, follow faiss\textquotesingle{}s style, allow the KNN index of multiple queries \\
\hline
{\em k} & the returned neighbors, i.\+e., will be the number of rows of each returned tensor \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
a vector of tensors, each tensor represent KNN results of one query in idx 
\end{DoxyReturn}


Reimplemented from \mbox{\hyperlink{classCANDY_1_1AbstractIndex_abed787ede5e68179978545d80e35deec}{CANDY\+::\+Abstract\+Index}}.

\mbox{\Hypertarget{classCANDY_1_1FlatIndex_a80608780f9aac45e9298a90731056fcf}\label{classCANDY_1_1FlatIndex_a80608780f9aac45e9298a90731056fcf}} 
\index{CANDY::KNNSearch@{CANDY::KNNSearch}!insertTensor@{insertTensor}}
\index{insertTensor@{insertTensor}!CANDY::KNNSearch@{CANDY::KNNSearch}}
\doxysubsubsection{\texorpdfstring{insertTensor()}{insertTensor()}}
{\footnotesize\ttfamily bool CANDY\+::\+Flat\+Index\+::insert\+Tensor (\begin{DoxyParamCaption}\item[{torch\+::\+Tensor \&}]{t }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



insert a tensor 


\begin{DoxyParams}{Parameters}
{\em t} & the tensor, accept multiple rows \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
bool whether the insertion is successful 
\end{DoxyReturn}


Reimplemented from \mbox{\hyperlink{classCANDY_1_1AbstractIndex_a10e65ecee21528fe6df84114b61110d4}{CANDY\+::\+Abstract\+Index}}.

\mbox{\Hypertarget{classCANDY_1_1FlatIndex_a44c1a243c76f7a54b5c01c57aba83ff2}\label{classCANDY_1_1FlatIndex_a44c1a243c76f7a54b5c01c57aba83ff2}} 
\index{CANDY::KNNSearch@{CANDY::KNNSearch}!rawData@{rawData}}
\index{rawData@{rawData}!CANDY::KNNSearch@{CANDY::KNNSearch}}
\doxysubsubsection{\texorpdfstring{rawData()}{rawData()}}
{\footnotesize\ttfamily torch\+::\+Tensor CANDY\+::\+Flat\+Index\+::raw\+Data (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



return the raw\+Data of tensor 

\begin{DoxyReturn}{Returns}
The raw data stored in tensor 
\end{DoxyReturn}


Reimplemented from \mbox{\hyperlink{classCANDY_1_1AbstractIndex_a2e1e1353dec39fc9eab887d97975448e}{CANDY\+::\+Abstract\+Index}}.

\mbox{\Hypertarget{classCANDY_1_1FlatIndex_a503565d2118cc8e5c70bb9356a9ffcb7}\label{classCANDY_1_1FlatIndex_a503565d2118cc8e5c70bb9356a9ffcb7}} 
\index{CANDY::KNNSearch@{CANDY::KNNSearch}!reviseTensor@{reviseTensor}}
\index{reviseTensor@{reviseTensor}!CANDY::KNNSearch@{CANDY::KNNSearch}}
\doxysubsubsection{\texorpdfstring{reviseTensor()}{reviseTensor()}}
{\footnotesize\ttfamily bool CANDY\+::\+Flat\+Index\+::revise\+Tensor (\begin{DoxyParamCaption}\item[{torch\+::\+Tensor \&}]{t,  }\item[{torch\+::\+Tensor \&}]{w }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



revise a tensor 


\begin{DoxyParams}{Parameters}
{\em t} & the tensor to be revised, recommend single row \\
\hline
{\em w} & the revised value \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
bool whether the revising is successful 
\end{DoxyReturn}


Reimplemented from \mbox{\hyperlink{classCANDY_1_1AbstractIndex_a90e72adba27ddcf8c71180f557bb78d5}{CANDY\+::\+Abstract\+Index}}.

\mbox{\Hypertarget{classCANDY_1_1FlatIndex_a1b1113af83b973be31c34994a5e87f11}\label{classCANDY_1_1FlatIndex_a1b1113af83b973be31c34994a5e87f11}} 
\index{CANDY::KNNSearch@{CANDY::KNNSearch}!searchIndex@{searchIndex}}
\index{searchIndex@{searchIndex}!CANDY::KNNSearch@{CANDY::KNNSearch}}
\doxysubsubsection{\texorpdfstring{searchIndex()}{searchIndex()}}
{\footnotesize\ttfamily std\+::vector$<$ faiss\+::idx\+\_\+t $>$ CANDY\+::\+Flat\+Index\+::search\+Index (\begin{DoxyParamCaption}\item[{torch\+::\+Tensor}]{q,  }\item[{int64\+\_\+t}]{k }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



search the k-\/\+NN of a query tensor, return their index 


\begin{DoxyParams}{Parameters}
{\em t} & the tensor, allow multiple rows \\
\hline
{\em k} & the returned neighbors \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
std\+::vector$<$faiss\+::idx\+\_\+t$>$ the index, follow faiss\textquotesingle{}s order 
\end{DoxyReturn}


Reimplemented from \mbox{\hyperlink{classCANDY_1_1AbstractIndex_a60e0f58c72ffbf47342b4c4b4091a573}{CANDY\+::\+Abstract\+Index}}.

\mbox{\Hypertarget{classCANDY_1_1FlatIndex_ac9ab4989ff2215d81fb1dc7c7d22ed6c}\label{classCANDY_1_1FlatIndex_ac9ab4989ff2215d81fb1dc7c7d22ed6c}} 
\index{CANDY::KNNSearch@{CANDY::KNNSearch}!searchTensor@{searchTensor}}
\index{searchTensor@{searchTensor}!CANDY::KNNSearch@{CANDY::KNNSearch}}
\doxysubsubsection{\texorpdfstring{searchTensor()}{searchTensor()}}
{\footnotesize\ttfamily std\+::vector$<$ torch\+::\+Tensor $>$ CANDY\+::\+Flat\+Index\+::search\+Tensor (\begin{DoxyParamCaption}\item[{torch\+::\+Tensor \&}]{q,  }\item[{int64\+\_\+t}]{k }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



search the k-\/\+NN of a query tensor, return the result tensors 


\begin{DoxyParams}{Parameters}
{\em t} & the tensor, allow multiple rows \\
\hline
{\em k} & the returned neighbors \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
std\+::vector$<$torch\+::\+Tensor$>$ the result tensor for each row of query 
\end{DoxyReturn}


Reimplemented from \mbox{\hyperlink{classCANDY_1_1AbstractIndex_a39069fe9cb1f16910695c091b768dbe8}{CANDY\+::\+Abstract\+Index}}.

\mbox{\Hypertarget{classCANDY_1_1FlatIndex_a67e201cac16e382a9735fc671a04ff26}\label{classCANDY_1_1FlatIndex_a67e201cac16e382a9735fc671a04ff26}} 
\index{CANDY::KNNSearch@{CANDY::KNNSearch}!setConfig@{setConfig}}
\index{setConfig@{setConfig}!CANDY::KNNSearch@{CANDY::KNNSearch}}
\doxysubsubsection{\texorpdfstring{setConfig()}{setConfig()}}
{\footnotesize\ttfamily bool CANDY\+::\+Flat\+Index\+::set\+Config (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{group__INTELLI__UTIL__CONFIGS_gaeb9674f6f5860b687d73f618962dfcea}{INTELLI\+::\+Config\+Map\+Ptr}}}]{cfg }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



set the index-\/specific config related to one index 


\begin{DoxyParams}{Parameters}
{\em cfg} & the config of this class \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
bool whether the configuration is successful 
\end{DoxyReturn}


Reimplemented from \mbox{\hyperlink{classCANDY_1_1AbstractIndex_a01f91296bd41aa55dd6a4c6465cc3a19}{CANDY\+::\+Abstract\+Index}}.

\mbox{\Hypertarget{classCANDY_1_1FlatIndex_ae598008bed9612befba457d842bb098b}\label{classCANDY_1_1FlatIndex_ae598008bed9612befba457d842bb098b}} 
\index{CANDY::KNNSearch@{CANDY::KNNSearch}!size@{size}}
\index{size@{size}!CANDY::KNNSearch@{CANDY::KNNSearch}}
\doxysubsubsection{\texorpdfstring{size()}{size()}}
{\footnotesize\ttfamily virtual int64\+\_\+t CANDY\+::\+Flat\+Index\+::size (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



return the size of ingested tensors 

\begin{DoxyReturn}{Returns}

\end{DoxyReturn}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
include/\+CANDY/\mbox{\hyperlink{FlatIndex_8h}{Flat\+Index.\+h}}\item 
src/\+CANDY/\mbox{\hyperlink{FlatIndex_8cpp}{Flat\+Index.\+cpp}}\end{DoxyCompactItemize}
